

if __name__ == '__main__':
    query='[CARD_NO: STRING, IC_CARDNO: STRING, NAME: STRING, SPELL_CODE: STRING, WB_CODE: STRING, BIRTHDAY: TIMESTAMP(6), SEX_CODE: STRING, IDENNO: STRING, BLOOD_CODE: STRING, PROF_CODE: STRING, WORK_HOME: STRING, WORK_TEL: STRING, WORK_ZIP: STRING, HOME: STRING, HOME_TEL: STRING, HOME_ZIP: STRING, DISTRICT: STRING, NATION_CODE: STRING, LINKMAN_NAME: STRING, LINKMAN_TEL: STRING, LINKMAN_ADD: STRING, RELA_CODE: STRING, MARI: STRING, COUN_CODE: STRING, PAYKIND_CODE: STRING, PAYKIND_NAME: STRING, PACT_CODE: STRING, PACT_NAME: STRING, MCARD_NO: STRING, AREA_CODE: STRING, FRAMT: STRING, ANAPHY_FLAG: STRING, HEPATITIS_FLAG: STRING, ACT_CODE: STRING, ACT_AMT: DECIMAL(10, 2), LACT_SUM: DECIMAL(10, 2), LBANK_SUM: DECIMAL(10, 2), ARREAR_TIMES: DECIMAL(10, 2), ARREAR_SUM: DECIMAL(10, 2), INHOS_SOURCE: STRING, LIHOS_DATE: TIMESTAMP(6), INHOS_TIMES: DECIMAL(10, 2), LOUTHOS_DATE: TIMESTAMP(6), FIR_SEE_DATE: TIMESTAMP(6), LREG_DATE: TIMESTAMP(6), DISOBY_CNT: STRING, END_DATE: TIMESTAMP(6), MARK: STRING, OPER_CODE: STRING, OPER_DATE: TIMESTAMP(6), IS_VALID: STRING, FEE_KIND: STRING, OLD_CARDNO: STRING, IS_ENCRYPTNAME: STRING, NORMALNAME: STRING, IDCARDTYPE: STRING, VIP_FLAG: STRING, MONTHER_NAME: STRING, IS_TREATMENT: STRING, CASE_NO: STRING, INSURANCE_ID: STRING, INSURANCE_NAME: STRING, HOME_DOOR_NO: STRING, LINKMAN_DOOR_NO: STRING, EMAIL: STRING, EMR_PATID: DECIMAL(10, 2), HEIGHT: STRING, WEIGHT: STRING, EMPI: STRING, CREATE_TIME: TIMESTAMP(6), CLINICALTRIAL_FLAG: STRING, CLINICALTRIAL_ID: STRING, genesis_new_id: CHAR(14) NOT NULL, genesis_upd: INT NOT NULL, genesis_del: INT NOT NULL, genesis_create_time: TIMESTAMP(0) NOT NULL, create_type: CHAR(5) NOT NULL]'
    sink='[CARD_NO: STRING, IC_CARDNO: STRING, NAME: STRING, SPELL_CODE: STRING, WB_CODE: STRING, BIRTHDAY: TIMESTAMP(6), SEX_CODE: STRING, IDENNO: STRING, BLOOD_CODE: STRING, PROF_CODE: STRING, WORK_HOME: STRING, WORK_TEL: STRING, WORK_ZIP: STRING, HOME: STRING, HOME_TEL: STRING, HOME_ZIP: STRING, DISTRICT: STRING, NATION_CODE: STRING, LINKMAN_NAME: STRING, LINKMAN_TEL: STRING, LINKMAN_ADD: STRING, RELA_CODE: STRING, MARI: STRING, COUN_CODE: STRING, PAYKIND_CODE: STRING, PAYKIND_NAME: STRING, PACT_CODE: STRING, PACT_NAME: STRING, MCARD_NO: STRING, AREA_CODE: STRING, FRAMT: STRING, ANAPHY_FLAG: STRING, HEPATITIS_FLAG: STRING, ACT_CODE: STRING, ACT_AMT: STRING, LACT_SUM: STRING, LBANK_SUM: STRING, ARREAR_TIMES: STRING, ARREAR_SUM: STRING, INHOS_SOURCE: STRING, LIHOS_DATE: TIMESTAMP(6), INHOS_TIMES: STRING, LOUTHOS_DATE: TIMESTAMP(6), FIR_SEE_DATE: TIMESTAMP(6), LREG_DATE: TIMESTAMP(6), DISOBY_CNT: STRING, END_DATE: TIMESTAMP(6), MARK: STRING, OPER_CODE: STRING, OPER_DATE: TIMESTAMP(6), IS_VALID: STRING, FEE_KIND: STRING, OLD_CARDNO: STRING, IS_ENCRYPTNAME: STRING, NORMALNAME: STRING, IDCARDTYPE: STRING, VIP_FLAG: STRING, MONTHER_NAME: STRING, IS_TREATMENT: STRING, CASE_NO: STRING, INSURANCE_ID: STRING, INSURANCE_NAME: STRING, HOME_DOOR_NO: STRING, LINKMAN_DOOR_NO: STRING, EMAIL: STRING, EMR_PATID: STRING, HEIGHT: STRING, WEIGHT: STRING, EMPI: STRING, CREATE_TIME: TIMESTAMP(6), CLINICALTRIAL_FLAG: STRING, CLINICALTRIAL_ID: STRING, genesis_new_id: STRING, genesis_upd: INT, genesis_del: INT, genesis_create_time: TIMESTAMP(6), create_type: STRING]'
    query=query.replace("[","").replace("]","")
    query_array=query.split(",")
    sink = sink.replace("[", "").replace("]", "")
    sink_array = sink.split(",")
    for i in range(len(query_array)):
        query_field = query_array[i].split(":")
        sink_field = sink_array[i].split(":")
        if(query_field[0]==sink_field[0]):
            if(sink_field[1].find(query_field[1])<0):
                print("column type not match {}->{}".format(query_field[1], sink_field[1]))
        else:
            print("column name not match {}->{}".format(query_field[0],sink_field[0]))

